<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UPAO Coordinator System</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }   

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
            background: #e8e8e8;
            color: #000000f5;
            line-height: 1.4;
        }

        .admin-container {
            display: flex;
            min-height: 100vh;
        }

        /* Updated sidebar styling to exactly match admin.html */
        .sidebar {
            width: 220px;
            background: #2c2c2c;
            color: #fff;
            position: fixed;
            height: 100vh;
            left: 0;
            top: 0;
            overflow-y: auto;
            border-right: 3px solid #000;
        }

        .sidebar-header {
            padding: 15px;
            background: #1a1a1a;
            border-bottom: 2px solid #000;
        }

        .logo-text h1 {
            font-size: 18px;
            font-weight: bold;
            color: #dbdedb;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .logo-text p {
            font-size: 11px;
            color: #888;
            text-transform: uppercase;
        }

        .sidebar-nav {
            padding: 10px 0;
        }

        .nav-section h3 {
            font-size: 10px;
            font-weight: bold;
            text-transform: uppercase;
            color: #666;
            padding: 10px 15px;
            letter-spacing: 1px;
        }

        .nav-menu {
            list-style: none;
        }

        .nav-link {
            display: block;
            padding: 12px 15px;
            color: #aaa;
            text-decoration: none;
            font-size: 13px;
            border-left: 3px solid transparent;
            transition: all 0.1s;
            cursor: pointer;
        }

        .nav-link:hover {
            background: #3a3a3a;
            color: #fff;
            border-left-color: #cccccc;
        }

        .nav-item.active .nav-link {
            background: #1a1a1a;
            color: #ffffff;
            border-left-color: #efefe6;
            font-weight: bold;
        }

        .sidebar-footer {
            position: absolute;
            bottom: 0;
            width: 220px;
            padding: 15px;
            background: #1a1a1a;
            border-top: 2px solid #000;
        }

        .user-info {
            font-size: 11px;
            color: #888;
        }

        .user-name {
            color: #fff;
            font-weight: bold;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 220px;
            background: #e8e8e8;
        }

        .header {
            background: #fff;
            border-bottom: 3px solid #000;
            padding: 15px 25px;
        }

        .header-title h1 {
            font-size: 20px;
            font-weight: bold;
            color: #000;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .header-title p {
            font-size: 11px;
            color: #666;
            text-transform: uppercase;
        }

        .content {
            padding: 20px;
        }

        .page-content {
            display: none;
        }

        .page-content.active {
            display: block;
        }

        /* Updated table styling to exactly match admin.html */
        .table-wrapper {
            background: #fff;
            border: 2px solid #000;
            margin-bottom: 20px;
        }

        .table-header {
            background: #000;
            color: #ffffff;
            padding: 10px 15px;
            font-size: 13px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 2px solid #000;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: #fff;
        }

        thead {
            background: #d0d0d0;
        }

        th {
            padding: 10px 12px;
            text-align: left;
            font-size: 11px;
            font-weight: bold;
            color: #000;
            text-transform: uppercase;
            border: 1px solid #999;
            letter-spacing: 0.5px;
        }

        td {
            padding: 10px 12px;
            border: 1px solid #ccc;
            font-size: 12px;
            color: #000;
            background: #fff;
        }

        tbody tr:nth-child(even) td {
            background: #f5f5f5;
        }

        .member-row {
            cursor: pointer;
        }

        .member-row:hover td {
            background: #fffacd !important;
        }

        /* Updated button styling to exactly match admin.html with Courier New font */
        .btn {
            padding: 6px 12px;
            border: 2px solid #000;
            background: #ffffff;
            color: #000;
            font-size: 11px;
            font-weight: bold;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.1s;
            font-family: 'Courier New', monospace;
        }

        .btn:hover {
            background: #000000;
            color: #ffffff;
        }

        .btn-primary {
            background: #000;
            color: #eff5ef;
        }

        .btn-primary:hover {
            background: #efefed;
            color: #000;
        }

        .btn-success {
            background: #ffffff;
            color: #000000;
            border-color: #006600;
        }

        .btn-success:hover {
            background: #159d00;
        }

        .btn-danger {
            background: #ffffff;
            color: #000000;
            border-color: #000000;
        }

        .btn-danger:hover {
            background: #ff0000;
        }

        .btn-sm {
            padding: 4px 8px;
            font-size: 10px;
        }

        .page-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        /* Updated status badge styling to match admin.html */
        .status-badge {
            padding: 4px 8px;
            font-size: 10px;
            text-transform: uppercase;
            border: 2px solid;
            letter-spacing: 0.5px;
        }

        .status-pending {
            background: #bdad21;
            color: #fffdfd;
        }

        .status-approved {
            background: #5fa74d;
            color: #ffffff;
        }

        .status-rejected {
            background: #c60c0c;
            color: #fdfdfd;
        }
        
        /* Added status-revised for accomplishments */
        .status-revised {
            background: #d4a017;
            color: #ffffff;
        }

        /* Updated filter container styling */
        .filter-container {
            margin-bottom: 15px;
            display: flex;
            gap: 10px;
            align-items: center;
            background: #fff;
            padding: 12px 15px;
            border: 2px solid #000;
        }

        .filter-container label {
            display: inline-block;
            font-size: 11px;
            font-weight: bold;
            color: #000;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .filter-container select {
            width: auto;
            min-width: 200px;
            padding: 8px;
            border: 2px solid #000;
            font-size: 12px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
            background: #fffcfc;
            color: #000;
        }

        .filter-container select:focus {
            outline: none;
            background: #f6f4f4;
        }

        /* Profile display in landscape layout matching admin style */
        .profile-display {
            background: #fff;
            border: 2px solid #000;
            margin-top: 20px;
            display: none;
        }

        .profile-display.show {
            display: block;
        }

        .profile-header-row {
            background: #000;
            color: #ffffff;
            padding: 10px 15px;
            font-size: 13px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .profile-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0;
        }

        .profile-field {
            padding: 12px 15px;
            border: 1px solid #ccc;
            display: flex;
            flex-direction: column;
            gap: 5px;
            background: #fff;
        }

        .profile-field:nth-child(even) {
            background: #f5f5f5;
        }

        .profile-field-label {
            font-size: 10px;
            font-weight: bold;
            text-transform: uppercase;
            color: #666;
            letter-spacing: 0.5px;
        }

        .profile-field-value {
            font-size: 13px;
            color: #000;
            font-weight: 500;
        }

        /* Upload section styling matching admin.html */
        .upload-section {
            background: #fff;
            border: 2px solid #000;
            margin-bottom: 20px;
        }

        .upload-header {
            background: #000;
            color: #ffffff;
            padding: 10px 15px;
            font-size: 13px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .upload-body {
            padding: 20px;
        }

        .upload-area {
            border: 3px dashed #000;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            background: #fafafa;
            transition: all 0.2s;
        }

        .upload-area:hover {
            background: #f0f0f0;
            border-color: #333;
        }

        .upload-text {
            font-size: 14px;
            font-weight: bold;
            text-transform: uppercase;
            color: #000;
            margin-top: 15px;
        }

        .upload-hint {
            font-size: 11px;
            color: #666;
            margin-top: 8px;
        }

        /* File list styling to exactly match admin.html */
        .file-list {
            margin-top: 20px;
        }

        .file-list table {
            width: 100%;
        }

        .file-item {
            cursor: default;
        }

        .file-name {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .file-name i {
            color: #666;
        }

        .file-actions {
            display: flex;
            gap: 5px;
            justify-content: flex-end;
        }

        /* Mobile menu button */
        .mobile-menu-btn {
            display: none;
            position: fixed;
            top: 15px;
            left: 15px;
            z-index: 2000;
            background: #000;
            color: white;
            border: 2px solid #000;
            padding: 10px 12px;
            cursor: pointer;
            font-size: 16px;
        }

        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.6);
            animation: fadeIn 0.3s ease-in-out;
        }

        .modal.show {
            display: block;
        }

        .modal-container {
            background-color: #fefefe;
            margin: 15vh auto;
            padding: 20px;
            border: 2px solid #000;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            border-radius: 5px;
            animation: zoomIn 0.3s ease-in-out;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 15px;
        }

        .modal-header h2 {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            text-transform: uppercase;
        }

        .modal-header h2 i {
            margin-right: 10px;
            color: #000;
        }

        .modal-close {
            font-size: 24px;
            font-weight: bold;
            color: #aaa;
            cursor: pointer;
            border: none;
            background: none;
            transition: color 0.2s;
        }

        .modal-close:hover {
            color: #333;
        }

        .modal-body {
            padding-bottom: 15px;
        }

        .modal-footer {
            border-top: 2px solid #eee;
            padding-top: 10px;
            margin-top: 15px;
            text-align: right;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes zoomIn {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        /* Specific profile modal styles */
        .profile-modal-avatar {
            width: 60px;
            height: 60px;
            background: #000;
            color: #fff;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .profile-modal-info h3 {
            font-size: 18px;
            font-weight: bold;
            color: #000;
            margin-bottom: 5px;
        }
        .profile-modal-info p {
            font-size: 11px;
            color: #666;
            text-transform: uppercase;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .mobile-menu-btn {
                display: block;
            }

            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s;
                z-index: 1500;
            }

            .sidebar.show {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .sidebar-footer {
                position: relative;
                width: 100%;
            }

            .header {
                padding: 15px 15px 15px 55px;
            }

            table {
                font-size: 10px;
            }

            th, td {
                padding: 8px 6px;
            }

            .profile-grid {
                grid-template-columns: 1fr;
            }

            .filter-container {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }

            .filter-container select {
                min-width: 100%;
            }

            .modal-container {
                width: 90%;
                margin: 10vh auto;
            }
        }

        /* Added login screen styles */
        .login-screen {
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #e8e8e8;
        }

        .login-container {
            background: #fff;
            border: 3px solid #000;
            padding: 40px;
            max-width: 450px;
            width: 90%;
        }

        .login-header {
            background: #000;
            color: #fff;
            padding: 15px;
            text-align: center;
            margin: -40px -40px 30px -40px;
            font-size: 18px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .login-form .form-group {
            margin-bottom: 20px;
        }

        .login-form label {
            display: block;
            font-size: 11px;
            font-weight: bold;
            text-transform: uppercase;
            color: #000;
            margin-bottom: 8px;
            letter-spacing: 0.5px;
        }

        .login-form select,
        .login-form input {
            width: 100%;
            padding: 12px;
            border: 2px solid #000;
            font-size: 13px;
            background: #fffcfc;
            color: #000;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
        }

        .login-form select:focus,
        .login-form input:focus {
            outline: none;
            background: #f6f4f4;
        }

        .login-btn {
            width: 100%;
            padding: 12px;
            background: #000;
            color: #fff;
            border: 2px solid #000;
            font-size: 13px;
            font-weight: bold;
            text-transform: uppercase;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            letter-spacing: 1px;
        }

        .login-btn:hover {
            background: #333;
        }

        .login-info {
            margin-top: 20px;
            padding: 15px;
            background: #f5f5f5;
            border: 2px solid #ccc;
            font-size: 11px;
            color: #666;
            text-align: center;
        }

        .form-control {
            width: 100%;
            padding: 10px;
            border: 2px solid #000;
            font-size: 12px;
            background: #fffcfc;
            color: #000;
            margin-bottom: 10px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
        }

        .form-control:focus {
            outline: none;
            background: #f6f4f4;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            font-size: 11px;
            font-weight: bold;
            text-transform: uppercase;
            color: #000;
            margin-bottom: 8px;
            letter-spacing: 0.5px;
        }

        textarea.form-control {
            min-height: 100px;
            resize: vertical;
        }

        /* Added member checkbox list styles */
        .member-checkbox-list {
            max-height: 300px;
            overflow-y: auto;
            border: 2px solid #000;
            padding: 10px;
            background: #fafafa;
            margin-bottom: 15px;
        }

        .member-checkbox-item {
            padding: 10px;
            border-bottom: 1px solid #ccc;
            display: flex;
            align-items: center;
            gap: 10px;
            background: #fff;
            margin-bottom: 5px;
        }

        .member-checkbox-item:last-child {
            margin-bottom: 0;
        }

        .member-checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .member-checkbox-item label {
            cursor: pointer;
            margin: 0;
            font-size: 12px;
            flex: 1;
        }

        .hidden {
            display: none !important;
        }

        /* Style for profile avatar in modal */
        .profile-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .profile-avatar {
            width: 50px;
            height: 50px;
            background: #000;
            color: #fff;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 18px;
            font-weight: bold;
        }

        .profile-info h3 {
            margin: 0;
            font-size: 20px;
            font-weight: bold;
            color: #333;
        }

        .profile-info p {
            margin: 0;
            font-size: 11px;
            color: #666;
            text-transform: uppercase;
        }
    </style>
</head>
<body>
    <!-- Added login screen -->
    <div id="loginScreen" class="login-screen">
        <div class="login-container">
            <div class="login-header">
                UPAO COORDINATOR LOGIN
            </div>
            <form class="login-form" id="loginForm" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label for="fieldSelect">Select Field of Arts</label>
                    <select id="fieldSelect" required>
                        <option value="">-- Select Your Field --</option>
                        <option value="Dance">Dance</option>
                        <option value="Music">Music</option>
                        <option value="Theater">Theater</option>
                        <option value="Visual Arts">Visual Arts</option>
                        <option value="Literary Arts">Literary Arts</option>
                        <option value="Film">Film</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="coordinatorName">Coordinator Name</label>
                    <input type="text" id="coordinatorName" placeholder="Enter your name" required>
                </div>
                <button type="submit" class="login-btn">Login to System</button>
            </form>
            <div class="login-info">
                You will only see members and data related to your assigned field of arts.
            </div>
        </div>
    </div>

    <!-- Added hidden class to main app, will be shown after login -->
    <div id="mainApp" class="hidden">
    <!-- Mobile menu button -->
    <button class="mobile-menu-btn" id="mobileMenuBtn">
        <i class="fas fa-bars"></i>
    </button>

    <div class="admin-container">
        <!-- Updated sidebar with dark theme -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo-text">
                    <h1>UPAO</h1>
                    <p>Coordinator System</p>
                </div>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <h3>Menu</h3>
                    <ul class="nav-menu">
                        <li class="nav-item active">
                            <a class="nav-link" data-page="dashboard">
                                <i class="fas fa-home"></i> Dashboard
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-page="members">
                                <i class="fas fa-users"></i> Members
                            </a>
                        </li>
                        <!-- Renamed from Events to Events and Performance -->
                        <li class="nav-item">
                            <a class="nav-link" data-page="events">
                                <i class="fas fa-calendar"></i> Events and Performance
                            </a>
                        </li>
                        <!-- Renamed from Documents to Accomplishments -->
                        <li class="nav-item">
                            <a class="nav-link" data-page="accomplishments">
                                <i class="fas fa-trophy"></i> Accomplishments
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>
            <!-- Updated sidebar footer to show logged-in coordinator info -->
            <div class="sidebar-footer">
                <div class="user-info">
                    <div class="user-name" id="coordinatorDisplayName">COORDINATOR</div>
                    <div id="coordinatorDisplayField">Arts Office</div>
                    <button class="btn btn-sm" onclick="logout()" style="margin-top: 10px; width: 100%;">Logout</button>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <div class="main-content">
            <!-- White header with black border -->
            <header class="header">
                <div class="header-title">
                    <h1 id="pageTitle">Dashboard</h1>
                    <p id="pageSubtitle">System Overview</p>
                </div>
            </header>

            <!-- Content -->
            <main class="content">
                <!-- Dashboard Content -->
                <div class="page-content active" id="dashboardContent">
                    <!-- System Statistics Table -->
                    <div class="table-wrapper">
                        <div class="table-header">System Statistics</div>
                        <table>
                            <thead>
                                <tr>
                                    <th>Metric</th>
                                    <th>Value</th>
                                    <th>Status</th>
                                    <th>Last Updated</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Total Members</td>
                                    <td><strong id="dashTotalMembers">0</strong></td>
                                    <td><span class="status-badge status-approved">ACTIVE</span></td>
                                    <td id="dashLastUpdate">2024-12-22</td>
                                </tr>
                                <tr>
                                    <td>Active Events</td>
                                    <td><strong>12</strong></td>
                                    <td><span class="status-badge status-approved">SCHEDULED</span></td>
                                    <td>2024-12-22</td>
                                </tr>
                                <tr>
                                    <td>Document Records</td>
                                    <td><strong id="dashTotalFiles">0</strong></td>
                                    <td><span class="status-badge status-approved">READY</span></td>
                                    <td>2024-12-22</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Recent Activity Table -->
                    <div class="table-wrapper">
                        <div class="table-header">Recent Activity Log</div>
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Activity</th>
                                    <th>Type</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>001</td>
                                    <td>Accessed member registry</td>
                                    <td>DATA ACCESS</td>
                                    <td>2024-12-22</td>
                                    <td><span class="status-badge status-approved">COMPLETED</span></td>
                                </tr>
                                <tr>
                                    <td>002</td>
                                    <td>Reviewed event records</td>
                                    <td>DATA ACCESS</td>
                                    <td>2024-12-22</td>
                                    <td><span class="status-badge status-approved">COMPLETED</span></td>
                                </tr>
                                <tr>
                                    <td>003</td>
                                    <td>Uploaded document</td>
                                    <td>FILE UPLOAD</td>
                                    <td>2024-12-21</td>
                                    <td><span class="status-badge status-approved">COMPLETED</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Members Content -->
                <div class="page-content" id="membersContent">
                    <div class="filter-container">
                        <label for="fieldFilter">Field:</label>
                        <select id="fieldFilter">
                            <option value="">All Fields</option>
                            <option value="Chorale">Chorale</option>
                            <option value="Dance">Dance</option>
                            <option value="Rondalla">Rondalla</option>
                            <option value="Live Band">Live Band</option>
                            <option value="Theater Arts">Theater Arts</option>
                            <option value="Visual Arts">Visual Arts</option>
                        </select>
                    </div>

                    <div class="table-wrapper">
                        <div class="table-header">Member Registry</div>
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Name</th>
                                    <th>Field</th>
                                    <th>Course</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="membersTableBody">
                                <tr>
                                    <td colspan="5" style="text-align: center; padding: 24px;">Loading...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Member Profile Modal -->
                    <div class="modal" id="memberProfileModal">
                        <div class="modal-container" style="max-width: 900px;">
                            <div class="modal-header">
                                <h2><i class="fas fa-user"></i> Member Profile</h2>
                                <button class="modal-close" onclick="closeMemberProfile()">&times;</button>
                            </div>
                            <div class="modal-body">
                                <div class="profile-header">
                                    <div class="profile-avatar" id="profileModalAvatar">AG</div>
                                    <div class="profile-info">
                                        <h3 id="profileModalName">Member Name</h3>
                                        <p id="profileModalId">Member ID: N/A</p>
                                        <p id="profileModalField">Field: N/A</p>
                                    </div>
                                </div>
                                <div class="profile-grid">
                                    <div class="profile-field">
                                        <div class="profile-field-label">Full Name</div>
                                        <div class="profile-field-value" id="profileModalFullName">-</div>
                                    </div>
                                    <div class="profile-field">
                                        <div class="profile-field-label">Member ID</div>
                                        <div class="profile-field-value" id="profileModalMemberId">-</div>
                                    </div>
                                    <div class="profile-field">
                                        <div class="profile-field-label">Email Address</div>
                                        <div class="profile-field-value" id="profileModalEmail">-</div>
                                    </div>
                                    <div class="profile-field">
                                        <div class="profile-field-label">Phone Number</div>
                                        <div class="profile-field-value" id="profileModalPhone">-</div>
                                    </div>
                                    <div class="profile-field">
                                        <div class="profile-field-label">Course & Year</div>
                                        <div class="profile-field-value" id="profileModalCourse">-</div>
                                    </div>
                                    <div class="profile-field">
                                        <div class="profile-field-label">Field of Arts</div>
                                        <div class="profile-field-value" id="profileModalFieldArts">-</div>
                                    </div>
                                    <div class="profile-field">
                                        <div class="profile-field-label">Date Joined</div>
                                        <div class="profile-field-value" id="profileModalJoinDate">-</div>
                                    </div>
                                    <div class="profile-field">
                                        <div class="profile-field-label">Status</div>
                                        <div class="profile-field-value" id="profileModalStatus">-</div>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button class="btn" onclick="closeMemberProfile()">Close</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Events and Performance Content -->
                <div class="page-content" id="eventsContent">
                    <!-- Added Performance Ranking Section at the top -->
                    <div class="table-wrapper">
                        <div class="table-header">Member Performance Ranking</div>
                        <div style="padding: 15px; background: #fff9e6; border: 2px solid #000; margin-bottom: 15px;">
                            <p style="font-size: 12px; margin: 0; color: #666;">
                                <strong>Auto-Evaluation:</strong> Members are ranked by total attendance across all events. 
                                Top performers are eligible for stipend claims.
                            </p>
                        </div>
                        <table>
                            <thead>
                                <tr>
                                    <th>Rank</th>
                                    <th>Member ID</th>
                                    <th>Name</th>
                                    <th>Total Events Attended</th>
                                    <th>Performance Score</th>
                                    <th>Stipend Eligible</th>
                                </tr>
                            </thead>
                            <tbody id="performanceRankingTableBody">
                                <tr>
                                    <td colspan="6" style="text-align: center; padding: 24px; color: #666;">No performance data available yet. Add events to see member rankings.</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Replaced Event Records table with new performance entry form -->
                    <div class="table-wrapper">
                        <div class="table-header">Add Event and Performance</div>
                        <div style="padding: 20px;">
                            <div class="form-group">
                                <label>What: (Event Name)</label>
                                <input type="text" id="eventNameInput" class="form-control" placeholder="Enter event name (e.g., Arts Festival 2024)">
                            </div>
                            
                            <div class="form-group">
                                <label>Select Members Who Attended</label>
                                <p style="font-size: 11px; color: #666; margin-bottom: 10px;">Check the members who attended this event. Unchecked members will be marked as absent.</p>
                                <div id="eventMemberCheckboxList" class="member-checkbox-list">
                                    <!-- Dynamically populated with checkboxes -->
                                </div>
                            </div>

                            <div class="form-group">
                                <label>Performance Notes (Optional)</label>
                                <p style="font-size: 11px; color: #666; margin-bottom: 10px;">Add general notes about the event or specific member performances.</p>
                                <textarea id="eventPerformanceNote" class="form-control" placeholder="Enter performance notes, observations, or evaluations..."></textarea>
                            </div>

                            <button class="btn btn-primary" onclick="saveEventAndPerformance()">
                                <i class="fas fa-save"></i> Save Event & Attendance
                            </button>
                        </div>
                    </div>

                    <!-- Added saved events and performance history table -->
                    <div class="table-wrapper" style="margin-top: 20px;">
                        <div class="table-header">Event History & Performance Records</div>
                        <table>
                            <thead>
                                <tr>
                                    <th>Event Name</th>
                                    <th>Date Added</th>
                                    <th>Attended</th>
                                    <th>Absent</th>
                                    <th>Notes</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="eventHistoryTableBody">
                                <tr>
                                    <td colspan="6" style="text-align: center; padding: 24px; color: #666;">No events recorded yet</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Removed old attendance modal and performance notes section -->
                </div>

                <!-- Accomplishments Content -->
                <div class="page-content" id="accomplishmentsContent">
                    <div class="upload-section">
                        <div class="upload-header">Upload Accomplishment Documents</div>
                        <div class="upload-body">
                            <div class="upload-area" id="uploadArea">
                                <i class="fas fa-cloud-upload-alt" style="font-size: 48px; color: #000;"></i>
                                <div class="upload-text">Click to upload documents</div>
                                <div class="upload-hint">Supported: PDF, DOC, DOCX, JPG, PNG (Max 10MB)</div>
                            </div>
                            <input type="file" id="fileInput" multiple style="display: none;" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png">
                        </div>
                    </div>

                    <div class="table-wrapper">
                        <div class="table-header">Accomplishment Documents Repository</div>
                        <table>
                            <thead>
                                <tr>
                                    <th>File Name</th>
                                    <th>Type</th>
                                    <th>Size</th>
                                    <th>Upload Date</th>
                                    <th>Upload Time</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="filesTableBody">
                                <tr>
                                    <td colspan="7" style="text-align: center; padding: 24px;">No documents uploaded</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </main>
        </div>
    </div>
    </div>

    <script>
        // Use the same localStorage key as admin.html for data synchronization
        const STORAGE_KEY = 'upao_members_data';
        const FILES_KEY = 'upao_accomplishment_files';
        const EVENTS_KEY = 'upao_coordinator_events';
        const AUTH_KEY = 'upao_coordinator_auth';

        let currentCoordinator = null;
        let coordinatorField = null;

        function handleLogin(event) {
            event.preventDefault();
            
            const field = document.getElementById('fieldSelect').value;
            const name = document.getElementById('coordinatorName').value.trim();

            if (!field || !name) {
                alert('Please fill in all fields');
                return;
            }

            // Save auth state
            currentCoordinator = name;
            coordinatorField = field;
            
            const authData = {
                name: name,
                field: field,
                loginTime: new Date().toISOString()
            };
            localStorage.setItem(AUTH_KEY, JSON.stringify(authData));

            // Update UI
            document.getElementById('coordinatorDisplayName').textContent = name.toUpperCase();
            document.getElementById('coordinatorDisplayField').textContent = field;

            // Show main app
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');

            // Load initial data
            updateDashboard();
            loadMembersTable();
            // Initial call for events page specific data
            populateEventMemberCheckboxes();
            loadEventHistoryTable();
            loadPerformanceRankingTable();
            loadFilesTable();
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                localStorage.removeItem(AUTH_KEY);
                currentCoordinator = null;
                coordinatorField = null;
                
                // Hide main app and show login
                document.getElementById('mainApp').classList.add('hidden');
                document.getElementById('loginScreen').classList.remove('hidden');
                
                // Reset form
                document.getElementById('fieldSelect').value = '';
                document.getElementById('coordinatorName').value = '';
            }
        }

        function checkAuth() {
            try {
                const authData = localStorage.getItem(AUTH_KEY);
                if (authData) {
                    const auth = JSON.parse(authData);
                    currentCoordinator = auth.name;
                    coordinatorField = auth.field;
                    
                    // Update UI
                    document.getElementById('coordinatorDisplayName').textContent = auth.name.toUpperCase();
                    document.getElementById('coordinatorDisplayField').textContent = auth.field;
                    
                    // Show main app
                    document.getElementById('loginScreen').classList.add('hidden');
                    document.getElementById('mainApp').classList.remove('hidden');
                    
                    return true;
                }
            } catch (e) {
                console.error('Error checking auth:', e);
            }
            return false;
        }

        // Load members from shared localStorage
        function loadMembersFromLocalStorage() {
            try {
                const stored = localStorage.getItem(STORAGE_KEY);
                if (stored) {
                    const data = JSON.parse(stored);
                    const allMembers = Array.isArray(data) ? data : [];
                    
                    // Filter by coordinator's field
                    if (coordinatorField) {
                        return allMembers.filter(member => member.field === coordinatorField);
                    }
                    return allMembers;
                }
            } catch (e) {
                console.error('Error loading members:', e);
            }
            return [];
        }

        function initializeSampleData() {
            const stored = localStorage.getItem(STORAGE_KEY);
            if (!stored || stored === '[]') {
                const sampleMembers = [
                    // Dance Members
                    { id: 'D2024001', name: 'Maria Santos', field: 'Dance', course: 'BS Psychology - 3rd Year', email: 'maria.santos@upao.edu', phone: '0912-345-6789', status: 'Active', joinDate: '2024-01-15' },
                    { id: 'D2024002', name: 'Carlos Reyes', field: 'Dance', course: 'BA Communication - 2nd Year', email: 'carlos.reyes@upao.edu', phone: '0923-456-7890', status: 'Active', joinDate: '2024-02-10' },
                    { id: 'D2024003', name: 'Ana Garcia', field: 'Dance', course: 'BS Education - 4th Year', email: 'ana.garcia@upao.edu', phone: '0934-567-8901', status: 'Active', joinDate: '2024-01-20' },
                    { id: 'D2024004', name: 'Jose Cruz', field: 'Dance', course: 'BA Sociology - 3rd Year', email: 'jose.cruz@upao.edu', phone: '0945-678-9012', status: 'Active', joinDate: '2024-03-05' },
                    { id: 'D2024005', name: 'Isabel Flores', field: 'Dance', course: 'BS Biology - 2nd Year', email: 'isabel.flores@upao.edu', phone: '0956-789-0123', status: 'Active', joinDate: '2024-02-28' },
                    
                    // Music Members
                    { id: 'M2024001', name: 'Ricardo Mendoza', field: 'Music', course: 'BA Music - 3rd Year', email: 'ricardo.mendoza@upao.edu', phone: '0917-234-5678', status: 'Active', joinDate: '2024-01-10' },
                    { id: 'M2024002', name: 'Sofia Ramos', field: 'Music', course: 'BS Education - 4th Year', email: 'sofia.ramos@upao.edu', phone: '0928-345-6789', status: 'Active', joinDate: '2024-02-15' },
                    { id: 'M2024003', name: 'Miguel Torres', field: 'Music', course: 'BA Communication - 2nd Year', email: 'miguel.torres@upao.edu', phone: '0939-456-7890', status: 'Active', joinDate: '2024-01-25' },
                    { id: 'M2024004', name: 'Elena Villanueva', field: 'Music', course: 'BS Psychology - 3rd Year', email: 'elena.villanueva@upao.edu', phone: '0940-567-8901', status: 'Active', joinDate: '2024-03-01' },
                    
                    // Theater Members
                    { id: 'T2024001', name: 'Roberto Santiago', field: 'Theater', course: 'BA Theater Arts - 3rd Year', email: 'roberto.santiago@upao.edu', phone: '0915-123-4567', status: 'Active', joinDate: '2024-01-12' },
                    { id: 'T2024002', name: 'Patricia Del Rosario', field: 'Theater', course: 'BA Communication - 4th Year', email: 'patricia.delrosario@upao.edu', phone: '0926-234-5678', status: 'Active', joinDate: '2024-02-20' },
                    { id: 'T2024003', name: 'Fernando Castillo', field: 'Theater', course: 'BS Education - 2nd Year', email: 'fernando.castillo@upao.edu', phone: '0937-345-6789', status: 'Active', joinDate: '2024-01-30' },
                    { id: 'T2024004', name: 'Carmen Lopez', field: 'Theater', course: 'BA Sociology - 3rd Year', email: 'carmen.lopez@upao.edu', phone: '0948-456-7890', status: 'Active', joinDate: '2024-03-10' },
                    
                    // Visual Arts Members
                    { id: 'V2024001', name: 'Antonio Bautista', field: 'Visual Arts', course: 'BFA Visual Arts - 3rd Year', email: 'antonio.bautista@upao.edu', phone: '0913-987-6543', status: 'Active', joinDate: '2024-01-08' },
                    { id: 'V2024002', name: 'Gabriela Morales', field: 'Visual Arts', course: 'BA Communication - 4th Year', email: 'gabriela.morales@upao.edu', phone: '0924-876-5432', status: 'Active', joinDate: '2024-02-12' },
                    { id: 'V2024003', name: 'Diego Herrera', field: 'Visual Arts', course: 'BS Architecture - 2nd Year', email: 'diego.herrera@upao.edu', phone: '0935-765-4321', status: 'Active', joinDate: '2024-01-22' },
                    { id: 'V2024004', name: 'Lucia Navarro', field: 'Visual Arts', course: 'BFA Painting - 3rd Year', email: 'lucia.navarro@upao.edu', phone: '0946-654-3210', status: 'Active', joinDate: '2024-03-08' },
                    
                    // Literary Arts Members
                    { id: 'L2024001', name: 'Gabriel Perez', field: 'Literary Arts', course: 'BA Literature - 3rd Year', email: 'gabriel.perez@upao.edu', phone: '0918-321-6547', status: 'Active', joinDate: '2024-01-18' },
                    { id: 'L2024002', name: 'Victoria Aquino', field: 'Literary Arts', course: 'BA Creative Writing - 4th Year', email: 'victoria.aquino@upao.edu', phone: '0929-432-7658', status: 'Active', joinDate: '2024-02-25' },
                    { id: 'L2024003', name: 'Emilio Gutierrez', field: 'Literary Arts', course: 'BA Communication - 2nd Year', email: 'emilio.gutierrez@upao.edu', phone: '0930-543-8769', status: 'Active', joinDate: '2024-01-28' },
                    
                    // Film Members
                    { id: 'F2024001', name: 'Rafael Domingo', field: 'Film', course: 'BA Film - 3rd Year', email: 'rafael.domingo@upao.edu', phone: '0919-654-9870', status: 'Active', joinDate: '2024-01-14' },
                    { id: 'F2024002', name: 'Angelica Marquez', field: 'Film', course: 'BA Communication - 4th Year', email: 'angelica.marquez@upao.edu', phone: '0920-765-0981', status: 'Active', joinDate: '2024-02-18' },
                    { id: 'F2024003', name: 'Leonardo Velasco', field: 'Film', course: 'BA Multimedia Arts - 2nd Year', email: 'leonardo.velasco@upao.edu', phone: '0931-876-1092', status: 'Active', joinDate: '2024-03-02' }
                ];
                
                localStorage.setItem(STORAGE_KEY, JSON.stringify(sampleMembers));
            }
        }

        function loadAccomplishmentFiles() {
            try {
                const stored = localStorage.getItem(FILES_KEY);
                if (stored) {
                    return JSON.parse(stored);
                }
            } catch (e) {
                console.error('Error loading files:', e);
            }
            return [];
        }

        function saveAccomplishmentFiles(files) {
            try {
                localStorage.setItem(FILES_KEY, JSON.stringify(files));
            } catch (e) {
                console.error('Error saving files:', e);
            }
        }

        function loadEventsData() {
            try {
                const stored = localStorage.getItem(EVENTS_KEY);
                if (stored) {
                    const allEvents = JSON.parse(stored);
                    // Filter events by coordinator's field
                    if (coordinatorField) {
                        return allEvents.filter(event => event.field === coordinatorField);
                    }
                    return allEvents;
                }
            } catch (e) {
                console.error('Error loading events:', e);
            }
            return [];
        }

        function saveEventsData(events) {
            try {
                // Load all events first
                const allStored = localStorage.getItem(EVENTS_KEY);
                let allEvents = allStored ? JSON.parse(allStored) : [];
                
                // Remove events from current field
                allEvents = allEvents.filter(event => event.field !== coordinatorField);
                
                // Add new events from current field
                allEvents = allEvents.concat(events);
                
                localStorage.setItem(EVENTS_KEY, JSON.stringify(allEvents));
            } catch (e) {
                console.error('Error saving events:', e);
            }
        }

        let accomplishmentFiles = loadAccomplishmentFiles();
        let eventRecords = [];

        function populateEventMemberCheckboxes() {
            const members = loadMembersFromLocalStorage();
            const container = document.getElementById('eventMemberCheckboxList');
            container.innerHTML = '';

            if (members.length === 0) {
                container.innerHTML = '<div style="padding: 20px; text-align: center; color: #666;">No members found for your field</div>';
                return;
            }

            members.forEach(member => {
                const item = document.createElement('div');
                item.className = 'member-checkbox-item';
                item.innerHTML = `
                    <input type="checkbox" id="event_member_${member.id}" value="${member.id}">
                    <label for="event_member_${member.id}">
                        <strong>${member.name}</strong> (${member.id})
                    </label>
                `;
                container.appendChild(item);
            });
        }

        function saveEventAndPerformance() {
            const eventName = document.getElementById('eventNameInput').value.trim();
            const performanceNote = document.getElementById('eventPerformanceNote').value.trim();

            if (!eventName) {
                alert('Please enter an event name');
                return;
            }

            // Get attended members
            const checkboxes = document.querySelectorAll('#eventMemberCheckboxList input[type="checkbox"]');
            const attendedMembers = [];
            const absentMembers = [];
            const allMembers = loadMembersFromLocalStorage();

            checkboxes.forEach(checkbox => {
                const memberId = checkbox.value;
                const member = allMembers.find(m => m.id === memberId);
                if (member) {
                    if (checkbox.checked) {
                        attendedMembers.push({ id: member.id, name: member.name });
                    } else {
                        absentMembers.push({ id: member.id, name: member.name });
                    }
                }
            });

            // Create event record
            const eventRecord = {
                id: Date.now(),
                eventName: eventName,
                field: coordinatorField,
                coordinatorName: currentCoordinator,
                dateAdded: new Date().toLocaleString(),
                attendedMembers: attendedMembers,
                absentMembers: absentMembers,
                performanceNote: performanceNote,
                timestamp: Date.now()
            };

            // Load existing events and add new one
            eventRecords = loadEventsData();
            eventRecords.push(eventRecord);
            saveEventsData(eventRecords);

            // Clear form
            document.getElementById('eventNameInput').value = '';
            document.getElementById('eventPerformanceNote').value = '';
            checkboxes.forEach(cb => cb.checked = false);

            // Reload table
            loadEventHistoryTable();
            loadPerformanceRankingTable();

            alert(`Event "${eventName}" saved successfully!\n${attendedMembers.length} attended, ${absentMembers.length} absent.`);
        }

        function loadEventHistoryTable() {
            eventRecords = loadEventsData();
            const tbody = document.getElementById('eventHistoryTableBody');
            tbody.innerHTML = '';

            if (eventRecords.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 24px; color: #666;">No events recorded yet</td></tr>';
                return;
            }

            // Sort by most recent first
            eventRecords.sort((a, b) => b.timestamp - a.timestamp);

            eventRecords.forEach((event, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${event.eventName}</strong></td>
                    <td>${event.dateAdded}</td>
                    <td>${event.attendedMembers.length} members</td>
                    <td>${event.absentMembers.length} members</td>
                    <td>${event.performanceNote || '<em style="color: #999;">No notes</em>'}</td>
                    <td>
                        <button class="btn btn-sm" onclick="viewEventDetails(${index})">View</button>
                        <button class="btn btn-sm btn-danger" onclick="deleteEvent(${index})">Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function viewEventDetails(index) {
            const event = eventRecords[index];
            if (!event) return;

            let attendedList = event.attendedMembers.map(m => m.name).join(', ') || 'None';
            let absentList = event.absentMembers.map(m => m.name).join(', ') || 'None';

            alert(`Event: ${event.eventName}\n\nDate: ${event.dateAdded}\n\nAttended (${event.attendedMembers.length}):\n${attendedList}\n\nAbsent (${event.absentMembers.length}):\n${absentList}\n\nPerformance Notes:\n${event.performanceNote || 'No notes recorded'}`);
        }

        function deleteEvent(index) {
            if (confirm('Are you sure you want to delete this event record?')) {
                eventRecords = loadEventsData();
                eventRecords.splice(index, 1);
                saveEventsData(eventRecords);
                loadEventHistoryTable();
                loadPerformanceRankingTable();
            }
        }
        
        function calculatePerformanceRanking() {
            const members = loadMembersFromLocalStorage();
            const events = loadEventsData();

            // Create performance map for each member
            const performanceMap = {};

            members.forEach(member => {
                performanceMap[member.id] = {
                    id: member.id,
                    name: member.name,
                    eventsAttended: 0,
                    performanceScore: 0
                };
            });

            // Count attendance for each member across all events
            events.forEach(event => {
                event.attendedMembers.forEach(attendedMember => {
                    if (performanceMap[attendedMember.id]) {
                        performanceMap[attendedMember.id].eventsAttended++;
                        // Simple performance score: 10 points per event attended
                        performanceMap[attendedMember.id].performanceScore += 10;
                    }
                });
            });

            // Convert to array and sort by performance score (highest first)
            const rankingArray = Object.values(performanceMap);
            rankingArray.sort((a, b) => b.performanceScore - a.performanceScore);

            return rankingArray;
        }

        function loadPerformanceRankingTable() {
            const ranking = calculatePerformanceRanking();
            const tbody = document.getElementById('performanceRankingTableBody');
            tbody.innerHTML = '';

            if (ranking.length === 0 || ranking.every(r => r.eventsAttended === 0)) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 24px; color: #666;">No performance data available yet. Add events to see member rankings.</td></tr>';
                return;
            }

            // Calculate stipend eligibility threshold (top 30% or minimum 3 events)
            // Find the maximum attendance count among all members
            const maxAttendance = ranking.length > 0 ? ranking[0].eventsAttended : 0;
            const stipendThreshold = Math.max(3, Math.ceil(maxAttendance * 0.7));

            ranking.forEach((member, index) => {
                const rank = index + 1;
                const isStipendEligible = member.eventsAttended >= stipendThreshold && member.eventsAttended > 0;
                
                const row = document.createElement('tr');
                // Highlight top performers with golden background
                if (isStipendEligible) {
                    row.style.background = '#fffbea';
                }
                
                row.innerHTML = `
                    <td><strong>${rank}</strong></td>
                    <td>${member.id}</td>
                    <td><strong>${member.name}</strong></td>
                    <td>${member.eventsAttended} events</td>
                    <td><strong>${member.performanceScore} pts</strong></td>
                    <td>
                        ${isStipendEligible 
                            ? '<span class="status-badge status-approved">ELIGIBLE</span>' 
                            : '<span class="status-badge status-pending">NOT YET</span>'}
                    </td>
                `;
                tbody.appendChild(row);
            });
        }


        // Navigation
        function switchPage(page) {
            // Update navigation
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                link.parentElement.classList.remove('active');
            });
            document.querySelector(`[data-page="${page}"]`).parentElement.classList.add('active');

            // Update content
            const contents = document.querySelectorAll('.page-content');
            contents.forEach(content => {
                content.classList.remove('active');
            });

            if (page === 'dashboard') {
                document.getElementById('dashboardContent').classList.add('active');
                updateDashboard();
            } else if (page === 'members') {
                document.getElementById('membersContent').classList.add('active');
                loadMembersTable();
            } else if (page === 'events') {
                document.getElementById('eventsContent').classList.add('active');
                populateEventMemberCheckboxes();
                loadEventHistoryTable();
                loadPerformanceRankingTable();
            } else if (page === 'accomplishments') {
                document.getElementById('accomplishmentsContent').classList.add('active');
                loadFilesTable();
            }

            // Close mobile menu if open
            if (window.innerWidth <= 768) {
                document.getElementById('sidebar').classList.remove('show');
            }
        }

        function loadMembersTable() {
            const members = loadMembersFromLocalStorage();
            const tbody = document.getElementById('membersTableBody');
            tbody.innerHTML = '';

            if (members.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; padding: 24px; color: #666;">No members found for your field</td></tr>';
                return;
            }

            const fieldFilter = document.getElementById('fieldFilter').value;

            members.forEach(member => {
                if (fieldFilter && member.field !== fieldFilter) {
                    return;
                }

                const row = document.createElement('tr');
                row.className = 'member-row';
                row.innerHTML = `
                    <td><strong>${member.id || 'N/A'}</strong></td>
                    <td>${member.name || 'N/A'}</td>
                    <td>${member.field || 'N/A'}</td>
                    <td>${member.course || 'N/A'}</td>
                    <td><span class="status-badge status-approved">${member.status || 'ACTIVE'}</span></td>
                `;
                row.addEventListener('click', function() {
                    openMemberProfile(member);
                });
                tbody.appendChild(row);
            });
        }

        function openMemberProfile(member) {
            // Get initials for avatar
            const nameParts = (member.name || 'NA').split(' ');
            const initials = nameParts.length > 1 
                ? nameParts[0][0] + nameParts[nameParts.length - 1][0]
                : nameParts[0][0] + (nameParts[0][1] || ''); // Handle single-letter names
            
            document.getElementById('profileModalAvatar').textContent = initials.toUpperCase();
            document.getElementById('profileModalName').textContent = member.name || 'N/A';
            document.getElementById('profileModalId').textContent = 'Member ID: ' + (member.id || 'N/A');
            document.getElementById('profileModalField').textContent = 'Field: ' + (member.field || 'N/A');
            
            document.getElementById('profileModalFullName').textContent = member.name || 'N/A';
            document.getElementById('profileModalMemberId').textContent = member.id || 'N/A';
            document.getElementById('profileModalEmail').textContent = member.email || 'N/A';
            document.getElementById('profileModalPhone').textContent = member.phone || 'N/A';
            document.getElementById('profileModalCourse').textContent = member.course || 'N/A';
            document.getElementById('profileModalFieldArts').textContent = member.field || 'N/A';
            document.getElementById('profileModalJoinDate').textContent = member.joinDate || 'N/A';
            document.getElementById('profileModalStatus').textContent = member.status || 'Active';

            document.getElementById('memberProfileModal').classList.add('show');
        }

        function closeMemberProfile() {
            document.getElementById('memberProfileModal').classList.remove('show');
        }

        // Load events table - No longer needed as it's replaced by new event/performance form
        // function loadEventsTable() { ... }

        document.getElementById('uploadArea').addEventListener('click', function() {
            document.getElementById('fileInput').click();
        });

        document.getElementById('fileInput').addEventListener('change', function(e) {
            const files = e.target.files;
            if (files.length === 0) return;

            const now = new Date();
            const uploadDate = now.toISOString().split('T')[0];
            const uploadTime = now.toTimeString().split(' ')[0];

            Array.from(files).forEach(file => {
                const fileData = {
                    name: file.name,
                    type: file.name.split('.').pop().toLowerCase(),
                    size: formatFileSize(file.size),
                    uploadDate: uploadDate,
                    uploadTime: uploadTime,
                    status: 'Pending'
                };
                accomplishmentFiles.push(fileData);
            });

            saveAccomplishmentFiles(accomplishmentFiles);
            loadFilesTable();
            alert(`Successfully uploaded ${files.length} accomplishment document(s)`);
            e.target.value = '';
        });

        function loadFilesTable() {
            const tbody = document.getElementById('filesTableBody');
            tbody.innerHTML = '';

            if (accomplishmentFiles.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; color: #666; padding: 24px;">No documents uploaded</td></tr>';
                return;
            }

            accomplishmentFiles.forEach((file, index) => {
                const row = document.createElement('tr');
                row.className = 'file-item';
                
                let statusClass = 'status-pending';
                if (file.status === 'Approved') {
                    statusClass = 'status-approved';
                } else if (file.status === 'For Revise') {
                    statusClass = 'status-revised';
                }
                
                row.innerHTML = `
                    <td class="file-name">
                        <i class="fas fa-file-alt"></i>
                        <span>${file.name}</span>
                    </td>
                    <td><strong>${file.type.toUpperCase()}</strong></td>
                    <td>${file.size}</td>
                    <td>${file.uploadDate || 'N/A'}</td>
                    <td>${file.uploadTime || 'N/A'}</td>
                    <td>
                        <span class="status-badge ${statusClass}">${file.status || 'Pending'}</span>
                    </td>
                    <td class="file-actions">
                        <button class="btn btn-sm" onclick="changeFileStatus(${index})">Change Status</button>
                        <button class="btn btn-sm btn-danger" onclick="deleteFile(${index})">Remove</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function downloadFile(index) {
            const file = accomplishmentFiles[index];
            alert(`Downloading: ${file.name}`);
            // In a real application, you would implement actual file download logic here.
        }

        function deleteFile(index) {
            if (confirm('Are you sure you want to remove this document?')) {
                accomplishmentFiles.splice(index, 1);
                saveAccomplishmentFiles(accomplishmentFiles);
                loadFilesTable();
                updateDashboard();
            }
        }

        function changeFileStatus(index) {
            const file = accomplishmentFiles[index];
            const statuses = ['Pending', 'For Revise', 'Approved'];
            const currentIndex = statuses.indexOf(file.status || 'Pending');
            const nextIndex = (currentIndex + 1) % statuses.length;
            
            accomplishmentFiles[index].status = statuses[nextIndex];
            saveAccomplishmentFiles(accomplishmentFiles);
            loadFilesTable();
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
        }

        // Update dashboard
        function updateDashboard() {
            const members = loadMembersFromLocalStorage();
            document.getElementById('dashTotalMembers').textContent = members.length;
            // Changed to use the correct key for accomplishments
            document.getElementById('dashTotalFiles').textContent = accomplishmentFiles.length; 
            document.getElementById('dashLastUpdate').textContent = new Date().toISOString().split('T')[0];
        }

        // Field filter
        document.getElementById('fieldFilter').addEventListener('change', function() {
            loadMembersTable();
        });

        document.getElementById('mobileMenuBtn').addEventListener('click', function() {
            document.getElementById('sidebar').classList.toggle('show');
        });

        // Close sidebar when clicking outside on mobile
        document.addEventListener('click', function(e) {
            if (window.innerWidth <= 768) {
                const sidebar = document.getElementById('sidebar');
                const menuBtn = document.getElementById('mobileMenuBtn');
                if (!sidebar.contains(e.target) && !menuBtn.contains(e.target)) {
                    sidebar.classList.remove('show');
                }
            }
        });

        // Initialize navigation
        document.querySelectorAll('.nav-link[data-page]').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const page = this.getAttribute('data-page');
                if (page) switchPage(page);
            });
        });

        // Initialize on load
        window.addEventListener('DOMContentLoaded', function() {
            initializeSampleData();
            
            // Check if already logged in
            const isLoggedIn = checkAuth();
            
            if (isLoggedIn) {
                updateDashboard();
                loadMembersTable();
                populateEventMemberCheckboxes();
                loadEventHistoryTable();
                loadPerformanceRankingTable();
                loadFilesTable();
            }

            // Set up login form
            document.getElementById('loginForm').addEventListener('submit', handleLogin);

            // Make sure initial tab (Dashboard) is active
            switchPage('dashboard'); // Use switchPage for initial display logic
        });

        // Refresh data when page becomes visible (for localStorage sync)
        document.addEventListener('visibilitychange', function() {
            if (!document.hidden) {
                // Reload all relevant data based on current page
                const currentPageElement = document.querySelector('.page-content.active');
                if (currentPageElement) {
                    const currentPageId = currentPageElement.id;
                    let currentPage = '';
                    if (currentPageId === 'dashboardContent') currentPage = 'dashboard';
                    else if (currentPageId === 'membersContent') currentPage = 'members';
                    else if (currentPageId === 'eventsContent') currentPage = 'events';
                    else if (currentPageId === 'accomplishmentsContent') currentPage = 'accomplishments';

                    if (currentPage) switchPage(currentPage); // This will reload data as needed
                }
            }
        });
    </script>
</body>
</html>
